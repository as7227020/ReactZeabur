{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import CourseService from\"../services/course.service\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const EnrollComponent=_ref=>{let{currentUser,setCurrentUser}=_ref;const navigate=useNavigate();let[searchInput,setSearchInput]=useState(\"\");//輸入文字監測\nlet[searchResult,setSearchResult]=useState(null);const handleTakeToLogin=()=>{navigate(\"/login\");};const handleChangeInput=e=>{setSearchInput(e.target.value);};const handleSearch=()=>{CourseService.getCourseByName(searchInput).then(data=>{setSearchResult(data.data);}).catch(e=>{console.log(e);});};const handleAllSearch=()=>{CourseService.getAll(searchInput).then(data=>{setSearchResult(data.data);}).catch(e=>{console.log(e);});};const handleEnroll=e=>{CourseService.enroll(e.target.id).then(()=>{window.alert(\"課程註冊成功!! 重新導向到課程頁面。\");navigate(\"/course\");}).catch(e=>{console.log(e);});};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"3rem\"},children:[!currentUser&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u60A8\\u5FC5\\u9808\\u5148\\u767B\\u5165\\u624D\\u80FD\\u958B\\u59CB\\u8A3B\\u518A\\u8AB2\\u7A0B\\u3002\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-lg\",onClick:handleTakeToLogin,children:\"\\u56DE\\u5230\\u767B\\u5165\\u9801\\u9762\"})]}),currentUser&&currentUser.user.role==\"instructor\"&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{children:\"\\u53EA\\u6709\\u5B78\\u751F\\u624D\\u80FD\\u5920\\u8A3B\\u518A\\u8AB2\\u7A0B\"})}),currentUser&&currentUser.user.role==\"student\"&&/*#__PURE__*/_jsxs(\"div\",{className:\"search input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:handleChangeInput}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSearch,className:\"btn btn-primary\",children:\"\\u641C\\u5C0B\\u8AB2\\u7A0B\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleAllSearch,className:\"btn btn-primary\",children:\"\\u5168\\u90E8\\u8AB2\\u7A0B\"})]}),currentUser&&searchResult&&searchResult.length!=0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u9019\\u662F\\u6211\\u5011\\u5F9EAPI\\u8FD4\\u56DE\\u7684\\u6578\\u64DA:\"}),searchResult.map(course=>{return/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{width:\"18rem\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",children:[\"\\u8AB2\\u7A0B\\u540D\\u7A31:\",course.title]}),/*#__PURE__*/_jsx(\"p\",{style:{margin:\"0.5rem 0rem\"},className:\"card-text\",children:course.description}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:\"0.5rem 0rem\"},children:[\"\\u5B78\\u751F\\u4EBA\\u6578: \",course.students.length]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:\"0.5rem 0rem\"},children:[\"\\u8AB2\\u7A0B\\u50F9\\u683C: \",course.price]}),/*#__PURE__*/_jsxs(\"p\",{style:{margin:\"0.5rem 0rem\"},children:[\"\\u8B1B\\u5E2B: \",course.instructor.username]}),/*#__PURE__*/_jsx(\"a\",{href:\"#\",id:course._id,className:\"card-text btn btn-primary\",onClick:handleEnroll,children:\"\\u8A3B\\u518A\\u8AB2\\u7A0B\"})]})},course._id);})]})]});};export default EnrollComponent;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","CourseService","jsx","_jsx","jsxs","_jsxs","EnrollComponent","_ref","currentUser","setCurrentUser","navigate","searchInput","setSearchInput","searchResult","setSearchResult","handleTakeToLogin","handleChangeInput","e","target","value","handleSearch","getCourseByName","then","data","catch","console","log","handleAllSearch","getAll","handleEnroll","enroll","id","window","alert","style","padding","children","className","onClick","user","role","type","onChange","length","map","course","width","title","margin","description","students","price","instructor","username","href","_id"],"sources":["D:/Fork/ReactProject/client/src/components/enroll-component.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport CourseService from \"../services/course.service\";\r\n\r\nconst EnrollComponent = ({ currentUser, setCurrentUser }) => {\r\n  const navigate = useNavigate();\r\n  let [searchInput, setSearchInput] = useState(\"\");//輸入文字監測\r\n  let [searchResult, setSearchResult] = useState(null);\r\n  const handleTakeToLogin = () => {\r\n    navigate(\"/login\");\r\n  };\r\n\r\n  const handleChangeInput = (e) => {\r\n    setSearchInput(e.target.value);\r\n  };\r\n\r\n  const handleSearch = () => {\r\n    CourseService.getCourseByName(searchInput)\r\n      .then((data) => {\r\n        setSearchResult(data.data);\r\n      })\r\n      .catch((e) => {\r\n        console.log(e);\r\n      });\r\n  };\r\n\r\n  const handleAllSearch = () => {\r\n    CourseService.getAll(searchInput)\r\n      .then((data) => {\r\n        setSearchResult(data.data);\r\n      })\r\n      .catch((e) => {\r\n        console.log(e);\r\n      });\r\n  };\r\n\r\n  const handleEnroll = (e) => {\r\n    CourseService.enroll(e.target.id)\r\n      .then(() => {\r\n        window.alert(\"課程註冊成功!! 重新導向到課程頁面。\");\r\n        navigate(\"/course\");\r\n      })\r\n      .catch((e) => {\r\n        console.log(e);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: \"3rem\" }}>\r\n      {!currentUser && (\r\n        <div>\r\n          <p>您必須先登入才能開始註冊課程。</p>\r\n          <button\r\n            className=\"btn btn-primary btn-lg\"\r\n            onClick={handleTakeToLogin}\r\n          >\r\n            回到登入頁面\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {currentUser && currentUser.user.role == \"instructor\" && (\r\n        <div>\r\n          <h1>只有學生才能夠註冊課程</h1>\r\n        </div>\r\n      )}\r\n      {currentUser && currentUser.user.role == \"student\" && (\r\n        <div className=\"search input-group mb-3\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"form-control\"\r\n            onChange={handleChangeInput}\r\n          />\r\n          <button onClick={handleSearch} className=\"btn btn-primary\">\r\n            搜尋課程\r\n          </button>\r\n          <button onClick={handleAllSearch} className=\"btn btn-primary\">\r\n            全部課程\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {currentUser && searchResult && searchResult.length != 0 && (\r\n        <div>\r\n          <p>這是我們從API返回的數據:</p>\r\n          {searchResult.map((course) => {\r\n            return (\r\n              <div key={course._id} className=\"card\" style={{ width: \"18rem\" }}>\r\n                <div className=\"card-body\">\r\n                  <h5 className=\"card-title\">課程名稱:{course.title}</h5>\r\n                  <p style={{ margin: \"0.5rem 0rem\" }} className=\"card-text\">\r\n                    {course.description}\r\n                  </p>\r\n                  <p style={{ margin: \"0.5rem 0rem\" }}>\r\n                    學生人數: {course.students.length}\r\n                  </p>\r\n                  <p style={{ margin: \"0.5rem 0rem\" }}>\r\n                    課程價格: {course.price}\r\n                  </p>\r\n                  <p style={{ margin: \"0.5rem 0rem\" }}>\r\n                    講師: {course.instructor.username}\r\n                  </p>\r\n\r\n                  <a\r\n                    href=\"#\"\r\n                    id={course._id}\r\n                    className=\"card-text btn btn-primary\"\r\n                    onClick={handleEnroll}\r\n                  >\r\n                    註冊課程\r\n                  </a>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EnrollComponent;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}